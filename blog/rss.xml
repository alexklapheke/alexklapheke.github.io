<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0">
	<channel>
		<title>Alexander Klapheke</title>
		<link>https://alexklapheke.github.io/</link>
		<description></description>
		<language>en-US</language>
		<lastBuildDate>2020-06-24T16:52:27-04:00</lastBuildDate>
		<item>
			<title>COVID-19 Sentiment Analysis</title>
			<link>https://alexklapheke.github.io/blog/publish/covid-sentiment.md</link>
			<pubDate>2020-06-23T15:58:12-04:00</pubDate>
	<description>
&lt;p&gt;This project is joint work with Luken Weaver, Jon Godin, and Reza Farrokhi.&lt;/p&gt;
&lt;div class=&quot;epigraph&quot;&gt;
&lt;p&gt;The Master said, &#8220;When the multitude hate a man, it is necessary to examine into the case. When the multitude like a man, it is necessary to examine into the case.&#8221;&lt;/p&gt;
&lt;/div&gt;
&lt;h1 id=&quot;background-problem-statement&quot;&gt;Background &amp;amp; problem statement&lt;/h1&gt;
&lt;p&gt;The COVID-19 crisis officially began in the US on January 20, when an infected traveler in Wuhan flew home to Washington State &lt;span class=&quot;citation&quot; data-cites=&quot;holshue2020first&quot;&gt;[@holshue2020first]&lt;/span&gt;. For the several months thence, in the absence of a unified national policy, states have engaged in a complicated fandango of business closures, mask orders, and quarantines for visitors. While it would take a much more sophisticated data analysis to gauge their effectiveness, we can look at how these policies were popularly received using social media sentiment as a proxy.&lt;/p&gt;
&lt;p&gt;We chose to compare sentiment between two cities in which the saga took quite different turns: New York, which suffered both an alarming outbreak and an austere lockdown (ongoing at time of writing), and Houston, which had a much easier time, with fewer infections than New York City had deaths, and a lockdown lasting barely a month (&lt;span class=&quot;citation&quot; data-cites=&quot;fig:nychou&quot;&gt;@fig:nychou&lt;/span&gt;).&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;covid-nyc-hou.svg&quot; alt=&quot;Case and death counts in New York City (all five boroughs) and in Harris County, Texas (which contains Houston) as of June 22. Data courtesy of the New York Times.   &#160;Cases  &#160;Deaths  &#160;Lockdown (statewide)&quot; id=&quot;fig:nychou&quot; /&gt;&lt;figcaption&gt;Case and death counts in New York City (all five boroughs) and in Harris County, Texas (which contains Houston) as of June 22. Data courtesy of the &lt;a href=&quot;https://github.com/nytimes/covid-19-data&quot;&gt;&lt;em&gt;New York Times&lt;/em&gt;&lt;/a&gt;.&lt;br&gt;&lt;br&gt; &lt;svg width=&quot;20&quot; height=&quot;4&quot;&gt;&lt;line x1=&quot;0&quot; y1=&quot;0&quot; x2=&quot;20&quot; y2=&quot;0&quot; stroke-width=&quot;4&quot; stroke=&quot;#081220&quot; /&gt;&lt;/svg&gt;&#160;Cases&lt;br&gt; &lt;svg width=&quot;20&quot; height=&quot;4&quot;&gt;&lt;line x1=&quot;0&quot; y1=&quot;0&quot; x2=&quot;20&quot; y2=&quot;0&quot; stroke-width=&quot;4&quot; stroke=&quot;#CE2A07&quot; /&gt;&lt;/svg&gt;&#160;Deaths&lt;br&gt; &lt;svg width=&quot;20&quot; height=&quot;10&quot;&gt;&lt;rect x=&quot;0&quot; y=&quot;0&quot; width=&quot;20&quot; height=&quot;10&quot; fill=&quot;#E0E0E0&quot; stroke=&quot;none&quot; /&gt;&lt;/svg&gt;&#160;Lockdown (statewide)&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;A na&#239;ve hypothesis would be that Houstonians, faring better overall, would speak with more positive affect. Complicating this, of course, is the profusion of topics on which people might converse, including: China, Donald Trump, Anthony Fauci, the CDC and WHO, governors Andrew Cuomo&lt;a href=&quot;#fn1&quot; class=&quot;footnote-ref&quot; id=&quot;fnref1&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; and Greg Abbott&lt;a href=&quot;#fn2&quot; class=&quot;footnote-ref&quot; id=&quot;fnref2&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;, cruise ships, quarantines, face masks, and the cancellations of events, not to mention the pathogen itself and its physiological effects. Our goal, therefore, was to isolate topics of conversation, and examine the sentiment surrounding particular public figures.&lt;/p&gt;
&lt;h1 id=&quot;data-collection&quot;&gt;Data collection&lt;/h1&gt;
&lt;p&gt;Our preferred data source was Twitter, which, with a third of a billion users, captures an enormous fraction of the public discourse. In addition, there is an up-to-date, curated &lt;a href=&quot;https://github.com/thepanacealab/covid19_twitter&quot;&gt;dataset&lt;/a&gt; of COVID-19 related tweets &lt;span class=&quot;citation&quot; data-cites=&quot;banda2020a&quot;&gt;[@banda2020a]&lt;/span&gt;. However, time and budget allowed few tweets to be captured&#8212;either on the order of 10&lt;sup&gt;3&lt;/sup&gt; total, or stretching back only seven days. In addition, the paucity of geotags&#8212;by &lt;a href=&quot;https://www.forbes.com/sites/kalevleetaru/2019/03/04/visualizing-seven-years-of-twitters-evolution-2012-2018/&quot;&gt;some estimates&lt;/a&gt;, on the order of 1%&#8212;would make filtering by city nearly impossible.&lt;/p&gt;
&lt;p&gt;Reddit turned out to be somewhat more hospitable, as &lt;a href=&quot;https://github.com/pushshift/api&quot;&gt;pushshift&lt;/a&gt; provides free access to the Reddit API, as well as a &lt;a href=&quot;http://files.pushshift.io/reddit/comments/&quot;&gt;full dataset&lt;/a&gt; of Reddit comments stretching back to the site&#8217;s founding &lt;span class=&quot;citation&quot; data-cites=&quot;baumgartner2020pushshift&quot;&gt;[@baumgartner2020pushshift]&lt;/span&gt;, although the latter source was not updated frequently enough for our purpose. Reddit users subscribe to interest communities called &#8220;subreddits&#8221;, prefixed with &#8220;/r/&#8221;, some of which are for cities and other locales. While it can&#8217;t be verified that a particular subscriber is a resident, we assume that a large proportion of them are. One downside of this structure is that subreddits can become &lt;a href=&quot;https://en.wikipedia.org/wiki/Echo_chamber_(media)&quot;&gt;echo chambers&lt;/a&gt; which do not represent the larger population.&lt;/p&gt;
&lt;!-- and gain (or lose) points for posting interesting, helpful, or funny comments in those communities. --&gt;
&lt;p&gt;Another difficulty is that although Reddit ranks in the &lt;a href=&quot;https://www.alexa.com/siteinfo/reddit.com&quot;&gt;top 20 websites&lt;/a&gt; by traffic, the volume of posts pales next to Twitter. Although each metropolitan subreddit records hundreds of thousands of subscribers, by the &lt;a href=&quot;https://en.wikipedia.org/wiki/1%25_rule_(Internet_culture)&quot;&gt;90&#8211;9&#8211;1 rule of thumb&lt;/a&gt;, we guessed that in a subreddit with on the order of 10&lt;sup&gt;5&lt;/sup&gt; subscribers, only about 10&lt;sup&gt;3&lt;/sup&gt; would be active commenters, as shown in &lt;span class=&quot;citation&quot; data-cites=&quot;tbl:commenters&quot;&gt;@tbl:commenters&lt;/span&gt;.&lt;/p&gt;
&lt;table&gt;
&lt;caption&gt;City and subreddit populations and commenter estimates {#tbl:commenters}&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&quot;header&quot;&gt;
&lt;th&gt;Subreddit&lt;/th&gt;
&lt;th&gt;City pop.&lt;/th&gt;
&lt;th&gt;Subscribers&lt;/th&gt;
&lt;th&gt;Casual commenters&lt;/th&gt;
&lt;th&gt;Active commenters&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td&gt;/r/nyc&lt;/td&gt;
&lt;td&gt;8,300,000&lt;/td&gt;
&lt;td&gt;225,000&lt;/td&gt;
&lt;td&gt;&#8776;20,000&lt;/td&gt;
&lt;td&gt;&#8776;2,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td&gt;/r/houston&lt;/td&gt;
&lt;td&gt;2,300,000&lt;/td&gt;
&lt;td&gt;150,000&lt;/td&gt;
&lt;td&gt;&#8776;13,500&lt;/td&gt;
&lt;td&gt;&#8776;1,500&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We focused on comments, since most of the substantive (read: sentiment-laden) discussion happens there; however, these are not guaranteed to contain topic-relevant keywords, so we searched for posts whose titles contained any of the keywords &#8220;COVID&#8221;, &#8220;coronavirus&#8221;, &#8220;quarantine&#8221;, or &#8220;pandemic&#8221;. Reddit &lt;a href=&quot;https://github.com/reddit-archive/reddit/blob/master/r2/r2/lib/utils/_utils.pyx#L39-L40&quot;&gt;generates&lt;/a&gt; a base 36 ID for each post and comment on the site, so we collated post IDs with comment IDs, as the simplified code snippet below illustrates.&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-1&quot; title=&quot;1&quot;&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; requests&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-2&quot; title=&quot;2&quot;&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; pandas &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; pd&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-3&quot; title=&quot;3&quot;&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-4&quot; title=&quot;4&quot;&gt;comments &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; []&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-5&quot; title=&quot;5&quot;&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-6&quot; title=&quot;6&quot;&gt;&lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; subreddit &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; [&lt;span class=&quot;st&quot;&gt;&amp;quot;nyc&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;houston&amp;quot;&lt;/span&gt;]:&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-7&quot; title=&quot;7&quot;&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-8&quot; title=&quot;8&quot;&gt;    &lt;span class=&quot;co&quot;&gt;# Get posts with the most comments&lt;/span&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-9&quot; title=&quot;9&quot;&gt;    res &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; requests.get(&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-10&quot; title=&quot;10&quot;&gt;        &lt;span class=&quot;st&quot;&gt;&amp;quot;https://api.pushshift.io/reddit/search/submission&amp;quot;&lt;/span&gt;,&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-11&quot; title=&quot;11&quot;&gt;        params &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; {&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-12&quot; title=&quot;12&quot;&gt;            &lt;span class=&quot;st&quot;&gt;&amp;quot;subreddit&amp;quot;&lt;/span&gt;: subreddit,&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-13&quot; title=&quot;13&quot;&gt;            &lt;span class=&quot;st&quot;&gt;&amp;quot;size&amp;quot;&lt;/span&gt;: &lt;span class=&quot;dv&quot;&gt;400&lt;/span&gt;,&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-14&quot; title=&quot;14&quot;&gt;            &lt;span class=&quot;st&quot;&gt;&amp;quot;sort_type&amp;quot;&lt;/span&gt;: &lt;span class=&quot;st&quot;&gt;&amp;quot;num_comments&amp;quot;&lt;/span&gt;,&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-15&quot; title=&quot;15&quot;&gt;            &lt;span class=&quot;st&quot;&gt;&amp;quot;sort&amp;quot;&lt;/span&gt;: &lt;span class=&quot;st&quot;&gt;&amp;quot;desc&amp;quot;&lt;/span&gt;,&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-16&quot; title=&quot;16&quot;&gt;        })&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-17&quot; title=&quot;17&quot;&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-18&quot; title=&quot;18&quot;&gt;    &lt;span class=&quot;co&quot;&gt;# Parse JSON&lt;/span&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-19&quot; title=&quot;19&quot;&gt;    posts &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; pd.DataFrame(res.json()[&lt;span class=&quot;st&quot;&gt;&amp;quot;data&amp;quot;&lt;/span&gt;])&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-20&quot; title=&quot;20&quot;&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-21&quot; title=&quot;21&quot;&gt;    &lt;span class=&quot;co&quot;&gt;# Get comments from posts&lt;/span&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-22&quot; title=&quot;22&quot;&gt;    res &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; requests.get(&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-23&quot; title=&quot;23&quot;&gt;        &lt;span class=&quot;st&quot;&gt;&amp;quot;https://api.pushshift.io/reddit/search/comment&amp;quot;&lt;/span&gt;,&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-24&quot; title=&quot;24&quot;&gt;        params &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; {&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-25&quot; title=&quot;25&quot;&gt;            &lt;span class=&quot;st&quot;&gt;&amp;quot;subreddit&amp;quot;&lt;/span&gt;: subreddit,&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-26&quot; title=&quot;26&quot;&gt;            &lt;span class=&quot;st&quot;&gt;&amp;quot;link_id&amp;quot;&lt;/span&gt;: ([&lt;span class=&quot;st&quot;&gt;&amp;quot;t3_&amp;quot;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; n &lt;span class=&quot;cf&quot;&gt;for&lt;/span&gt; n &lt;span class=&quot;kw&quot;&gt;in&lt;/span&gt; posts[&lt;span class=&quot;st&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;]]),&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-27&quot; title=&quot;27&quot;&gt;            &lt;span class=&quot;st&quot;&gt;&amp;quot;size&amp;quot;&lt;/span&gt;: &lt;span class=&quot;dv&quot;&gt;1000&lt;/span&gt;,&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-28&quot; title=&quot;28&quot;&gt;        })&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-29&quot; title=&quot;29&quot;&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-30&quot; title=&quot;30&quot;&gt;    &lt;span class=&quot;co&quot;&gt;# Collect parsed output&lt;/span&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb1-31&quot; title=&quot;31&quot;&gt;    comments.append(pd.DataFrame(res.json()[&lt;span class=&quot;st&quot;&gt;&amp;quot;data&amp;quot;&lt;/span&gt;]))&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In toto, we collected 150,000 comments from /r/nyc, and 85,000 from /r/houston, and randomly sampled 85,000 New York comments for the analysis to avoid variance issues.&lt;/p&gt;
&lt;h1 id=&quot;sentiment-analysis&quot;&gt;Sentiment analysis&lt;/h1&gt;
&lt;p&gt;The sentiment analysis itself was done with the VADER sentiment parser &lt;span class=&quot;citation&quot; data-cites=&quot;vader&quot;&gt;[@vader]&lt;/span&gt;, a sophisticated rule-based parser that incorporates contextual information such as negations (&#8220;not&#8221;), intensifiers (&#8220;very&#8221;), hedges (&#8220;somewhat&#8221;), and even emoticons (&#8220;:)&#8221;).&lt;a href=&quot;#fn3&quot; class=&quot;footnote-ref&quot; id=&quot;fnref3&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt; For these reasons, it works best on unprocessed text:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb2&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;a class=&quot;sourceLine&quot; id=&quot;cb2-1&quot; title=&quot;1&quot;&gt;&lt;span class=&quot;im&quot;&gt;from&lt;/span&gt; nltk.sentiment.vader &lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; SentimentIntensityAnalyzer&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb2-2&quot; title=&quot;2&quot;&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb2-3&quot; title=&quot;3&quot;&gt;&lt;span class=&quot;co&quot;&gt;# Instantiate sentiment analyzer &amp;amp; compute sentiments&lt;/span&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb2-4&quot; title=&quot;4&quot;&gt;analyzer &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; SentimentIntensityAnalyzer()&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb2-5&quot; title=&quot;5&quot;&gt;sentiments &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; pd.DataFrame(&lt;span class=&quot;bu&quot;&gt;map&lt;/span&gt;(analyzer.polarity_scores, comments[&lt;span class=&quot;st&quot;&gt;&amp;quot;text&amp;quot;&lt;/span&gt;]))&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb2-6&quot; title=&quot;6&quot;&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb2-7&quot; title=&quot;7&quot;&gt;&lt;span class=&quot;co&quot;&gt;# Append to original data frame&lt;/span&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb2-8&quot; title=&quot;8&quot;&gt;comments &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; comments.join(sentiments.set_index(comments.index))&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It provides a &#8220;sentiment intensity&#8221; score which is signed for polarity (positive good, negative bad). We took the 5-day rolling mean of the sentiments of all comments, filtering for various keywords.&lt;/p&gt;
&lt;!-- ![](Sentiment-Governors-5day.svg){#fig:gov} --&gt;
&lt;p&gt;Two important caveats apply, the first of which is that knowing &lt;em&gt;what&lt;/em&gt; the sentiment is doesn&#8217;t tell you &lt;em&gt;why&lt;/em&gt;. For example, in late April, /r/nyc responded negatively to the keyword &#8220;Fauci&#8221;, but this turned out to be displeasure not with Fauci himself, but rather with Trump, who had considered firing him. Thus, sentiment &lt;em&gt;around&lt;/em&gt; a public figure should not be conflated with sentiment &lt;em&gt;toward&lt;/em&gt; that figure. The second caveat is that positive and negative sentiments can cancel; so although a highly positive or negative overall sentiment score reflects unanimity in these feelings, a neutral score does not represent apathy, but simply lack of consensus.&lt;/p&gt;
&lt;p&gt;One way consensus is achieved on Reddit is by voting: users vote for (&#8220;upvote&#8221;) or against (&#8220;downvote&#8221;) comments, and the comment&#8217;s score is the number of votes for minus the number against. If voting is a way of agreeing with the sentiment of a comment, then it can be seen as tacitly expressing the same sentiment. We accounted for this by eliminating comments that scored less than one, and weighting the sentiment of the remainder by their scores:&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb3&quot;&gt;&lt;pre class=&quot;sourceCode python&quot;&gt;&lt;code class=&quot;sourceCode python&quot;&gt;&lt;a class=&quot;sourceLine&quot; id=&quot;cb3-1&quot; title=&quot;1&quot;&gt;&lt;span class=&quot;im&quot;&gt;import&lt;/span&gt; numpy &lt;span class=&quot;im&quot;&gt;as&lt;/span&gt; np&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb3-2&quot; title=&quot;2&quot;&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb3-3&quot; title=&quot;3&quot;&gt;comments[&lt;span class=&quot;st&quot;&gt;&amp;quot;weighted&amp;quot;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; np.maximum(&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;,&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb3-4&quot; title=&quot;4&quot;&gt;    &lt;span class=&quot;co&quot;&gt;# Sentiment score&lt;/span&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb3-5&quot; title=&quot;5&quot;&gt;    comments[&lt;span class=&quot;st&quot;&gt;&amp;quot;compound&amp;quot;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb3-6&quot; title=&quot;6&quot;&gt;    &lt;span class=&quot;co&quot;&gt;# Reddit score&lt;/span&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb3-7&quot; title=&quot;7&quot;&gt;    comments[&lt;span class=&quot;st&quot;&gt;&amp;quot;score&amp;quot;&lt;/span&gt;] &lt;span class=&quot;op&quot;&gt;*&lt;/span&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb3-8&quot; title=&quot;8&quot;&gt;    &lt;span class=&quot;co&quot;&gt;# Scaling factor (for convenience; does not change analysis)&lt;/span&gt;&lt;/a&gt;
&lt;a class=&quot;sourceLine&quot; id=&quot;cb3-9&quot; title=&quot;9&quot;&gt;    &lt;span class=&quot;fl&quot;&gt;0.75&lt;/span&gt;)&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;One potential pitfall is that since the highest-scoring comments appear highest on the page, this can be subject to the &lt;a href=&quot;https://en.wikipedia.org/wiki/Bandwagon_effect&quot;&gt;bandwagon effect&lt;/a&gt;, by which users see, and then upvote, comments that are already popular.&lt;/p&gt;
&lt;p&gt;We graphed the weighted sentiments of COVID-related posts in 2020 (&lt;span class=&quot;citation&quot; data-cites=&quot;fig:2020&quot;&gt;@fig:2020&lt;/span&gt;), and formulated a baseline sentiment for comparison&#8212;maybe sentiment is more positive in haler times, or maybe New Yorkers really are &lt;a href=&quot;https://www.youtube.com/watch?v=lX4MoaTFp9g&quot;&gt;less positive&lt;/a&gt; in general&#8212;so we looked at comments from the same months in the previous year, without filtering by keyword (&lt;span class=&quot;citation&quot; data-cites=&quot;fig:2019&quot;&gt;@fig:2019&lt;/span&gt;).&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;Sentiment-Citywide-2020-5day.svg&quot; alt=&quot;COVID-related sentiment across cities, 2020 (5-day rolling mean)   &#160;New York  &#160;Houston &quot; id=&quot;fig:2020&quot; /&gt;&lt;figcaption&gt;COVID-related sentiment across cities, 2020 (5-day rolling mean)&lt;br&gt;&lt;br&gt; &lt;svg width=&quot;20&quot; height=&quot;4&quot;&gt;&lt;line x1=&quot;0&quot; y1=&quot;0&quot; x2=&quot;20&quot; y2=&quot;0&quot; stroke-width=&quot;4&quot; stroke=&quot;#FF5500&quot; /&gt;&lt;/svg&gt;&#160;New York&lt;br&gt; &lt;svg width=&quot;20&quot; height=&quot;4&quot;&gt;&lt;line x1=&quot;0&quot; y1=&quot;0&quot; x2=&quot;20&quot; y2=&quot;0&quot; stroke-width=&quot;4&quot; stroke=&quot;#0658CF&quot; /&gt;&lt;/svg&gt;&#160;Houston&lt;br&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The overall results were unilluminating; the only particularly positive or negative periods, in February 2020, are essentially artifacts due to insufficient data (the virus had not yet seized the nation&#8217;s attention).&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;Sentiment-Citywide-2019-5day.svg&quot; alt=&quot;General sentiment across cities, 2019 (5-day rolling mean)   &#160;New York  &#160;Houston &quot; id=&quot;fig:2019&quot; /&gt;&lt;figcaption&gt;General sentiment across cities, 2019 (5-day rolling mean)&lt;br&gt;&lt;br&gt; &lt;svg width=&quot;20&quot; height=&quot;4&quot;&gt;&lt;line x1=&quot;0&quot; y1=&quot;0&quot; x2=&quot;20&quot; y2=&quot;0&quot; stroke-width=&quot;4&quot; stroke=&quot;#FF5500&quot; /&gt;&lt;/svg&gt;&#160;New York&lt;br&gt; &lt;svg width=&quot;20&quot; height=&quot;4&quot;&gt;&lt;line x1=&quot;0&quot; y1=&quot;0&quot; x2=&quot;20&quot; y2=&quot;0&quot; stroke-width=&quot;4&quot; stroke=&quot;#0658CF&quot; /&gt;&lt;/svg&gt;&#160;Houston&lt;br&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;A clearer picture arose around public figures. After filtering by the surname of each state&#8217;s governor, we see a positive spike in New York in the early days of shutdowns, whereas Houston takes a swift negative turn when Abbott declares lockdown, and swiftly becomes positive after he orders its end (&lt;span class=&quot;citation&quot; data-cites=&quot;fig:gov&quot;&gt;@fig:gov&lt;/span&gt;).&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;Sentiment-Governors-5day.svg&quot; alt=&quot;Sentiment around governors across cities, 2020 (5-day rolling mean)   &#160;New York (Keyword &#8220;Cuomo&#8221;)  &#160;Houston (Keyword &#8220;Abbott&#8221;) &quot; id=&quot;fig:gov&quot; /&gt;&lt;figcaption&gt;Sentiment around governors across cities, 2020 (5-day rolling mean)&lt;br&gt;&lt;br&gt; &lt;svg width=&quot;20&quot; height=&quot;4&quot;&gt;&lt;line x1=&quot;0&quot; y1=&quot;0&quot; x2=&quot;20&quot; y2=&quot;0&quot; stroke-width=&quot;4&quot; stroke=&quot;#FF5500&quot; /&gt;&lt;/svg&gt;&#160;New York (Keyword &#8220;Cuomo&#8221;)&lt;br&gt; &lt;svg width=&quot;20&quot; height=&quot;4&quot;&gt;&lt;line x1=&quot;0&quot; y1=&quot;0&quot; x2=&quot;20&quot; y2=&quot;0&quot; stroke-width=&quot;4&quot; stroke=&quot;#0658CF&quot; /&gt;&lt;/svg&gt;&#160;Houston (Keyword &#8220;Abbott&#8221;)&lt;br&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;This seems to imply that New Yorkers, having been much harder hit, were more sanguine about curtailments of public life than the relatively freewheeling Texans.&lt;/p&gt;
&lt;p&gt;A similarly revealing pattern is shown in response to the keyword &#8220;Trump&#8221; (&lt;span class=&quot;citation&quot; data-cites=&quot;fig:trump&quot;&gt;@fig:trump&lt;/span&gt;). While comments about the president tended negative overall, they dipped steeply in late April, possibly in response to his defunding the WHO.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;Sentiment-Trump-5day.svg&quot; alt=&quot;Sentiment around President Trump across cities, 2020 (5-day rolling mean)   &#160;New York (Keyword &#8220;Trump&#8221;)  &#160;Houston (Keyword &#8220;Trump&#8221;) &quot; id=&quot;fig:trump&quot; /&gt;&lt;figcaption&gt;Sentiment around President Trump across cities, 2020 (5-day rolling mean)&lt;br&gt;&lt;br&gt; &lt;svg width=&quot;20&quot; height=&quot;4&quot;&gt;&lt;line x1=&quot;0&quot; y1=&quot;0&quot; x2=&quot;20&quot; y2=&quot;0&quot; stroke-width=&quot;4&quot; stroke=&quot;#FF5500&quot; /&gt;&lt;/svg&gt;&#160;New York (Keyword &#8220;Trump&#8221;)&lt;br&gt; &lt;svg width=&quot;20&quot; height=&quot;4&quot;&gt;&lt;line x1=&quot;0&quot; y1=&quot;0&quot; x2=&quot;20&quot; y2=&quot;0&quot; stroke-width=&quot;4&quot; stroke=&quot;#0658CF&quot; /&gt;&lt;/svg&gt;&#160;Houston (Keyword &#8220;Trump&#8221;)&lt;br&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h1 id=&quot;conclusions&quot;&gt;Conclusions&lt;/h1&gt;
&lt;p&gt;We have shown that public attitudes as expressed on social media can be tied to world events, and analyzed attitudes toward events during the COVID-19 crisis. This analysis could be expanded with, e.g., a more sophisticated weighting scheme, more precise filtering, or a larger dataset.&lt;/p&gt;
&lt;section class=&quot;footnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot;&gt;&lt;p&gt;Dem., NY, in office since 2011&lt;a href=&quot;#fnref1&quot; class=&quot;footnote-back&quot;&gt;&#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn2&quot;&gt;&lt;p&gt;Rep., TX, in office since 2015&lt;a href=&quot;#fnref2&quot; class=&quot;footnote-back&quot;&gt;&#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&quot;fn3&quot;&gt;&lt;p&gt;Some sample inputs and scores are shown below:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&quot;header&quot;&gt;
&lt;th&gt;Text&lt;/th&gt;
&lt;th&gt;Score&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td&gt;great!&lt;/td&gt;
&lt;td&gt;+0.6588&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td&gt;great&lt;/td&gt;
&lt;td&gt;+0.6249&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td&gt;very good&lt;/td&gt;
&lt;td&gt;+0.4927&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td&gt;good&lt;/td&gt;
&lt;td&gt;+0.4404&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td&gt;not bad&lt;/td&gt;
&lt;td&gt;+0.4310&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td&gt;somewhat good&lt;/td&gt;
&lt;td&gt;+0.3832&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td&gt;okay&lt;/td&gt;
&lt;td&gt;+0.2263&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td&gt;meh&lt;/td&gt;
&lt;td&gt;&#8722;0.0772&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td&gt;not good&lt;/td&gt;
&lt;td&gt;&#8722;0.3412&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td&gt;bad&lt;/td&gt;
&lt;td&gt;&#8722;0.5423&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;a href=&quot;#fnref3&quot; class=&quot;footnote-back&quot;&gt;&#8617;&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
	</description>
		</item>
		<item>
			<title>Foreword</title>
			<link>https://alexklapheke.github.io/blog/publish/foreword.md</link>
			<pubDate>2020-06-22T06:10:59-04:00</pubDate>
	<description>
&lt;div class=&quot;epigraph&quot;&gt;
&lt;p&gt;I should not talk so much about myself if there were anybody else whom I knew as well.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;As a preface to this blog, let me introduce myself: I&#8217;m a linguist turned data scientist living in the Boston area. While a lot of my work deals with natural language, I&#8217;m interested in the gamut of data and what knowledge can be gleaned from it. &lt;!-- Typifying this is the current COVID-19 crisis---Massachusetts is now in the thirteenth week of a state of emergency---during which uncertainty, epidemiological data (&quot;[The Curve](https://en.wikipedia.org/wiki/Epidemic_curve)&quot;) has been exalted almost to a kind of augury. --&gt; I won&#8217;t comment much on pop data science or world events, but I hope that through reasoned analysis I can provide clarity about what data I can get hold of.&lt;/p&gt;
&lt;p&gt;I entered data science after leaving academia, but the transition wasn&#8217;t abrupt. I&#8217;d learned to code some years prior, and ran experiments as a graduate student, punctiliously collecting small data sets, modeling them in R, and encapsulating the results in manuscripts and slides. The tools I use have changed (Python largely displacing R), and the data sets are some orders of magnitude larger, but my work in graduate school laid the flagstones for a data science career.&lt;/p&gt;
&lt;p&gt;This blog will mainly comprise overviews of the data projects I&#8217;m working on, essays on how I approach data, particularly language data, and posts about how I use various tools&#8212;not just programming languages and text editors, but also models and theorems. I hope not only to showcase what insights can be loosed from a dataset (and what illusory insights come of unsound analyses), but also serve as an aid and reference to other data scientists&#8212;not least among whom, my future self. A full portfolio of my work can be found on &lt;a href=&quot;https://alexklaphe.github.io/&quot;&gt;my homepage&lt;/a&gt;.&lt;/p&gt;
&lt;!-- The good news now is that, as the graph below shows, the curve seems to have peaked,[^rcode] and while it would be remiss to hazard that we&apos;re in the clear, or comment on the efficacy of this or that public health policy, I will say that I look forward to writing about my data investigations, and 

![New COVID-19 cases in Massachusetts (14-day moving average)](covid-mass.svg)\

[^rcode]: The full R code to generate this graph is below:

    ```r
    library(tidyverse)
    svg(&quot;covid-mass.svg&quot;, width = 5, height = 5)

    us_state &lt;- &quot;Massachusetts&quot;
    days &lt;- 14

    read.csv(&quot;https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-states.csv&quot;) %&gt;%
    filter(state == us_state) %&gt;%
    mutate(date = as.POSIXct(date, format = &quot;%F&quot;)) %&gt;%
    mutate(newcases = cases - c(0, head(cases, -1))) %&gt;%
    mutate(newcases_moving = stats::filter(newcases, rep(1 / days, days))) %&gt;%
    ggplot(aes(x = date, y = newcases_moving)) +
    geom_point() +
    theme_classic() +
    theme(
            text = element_text(family = &quot;Linux Libertine O&quot;),
            axis.line = element_blank(),
            panel.grid.major.y = element_line(colour = &quot;gray90&quot;)
        ) +
    labs(
            title = paste0(&quot;New cases in &quot;, us_state, &quot; (&quot;, days, &quot;-day moving average)&quot;),
            subtitle = bquote(paste(&quot;Data courtesy of the &quot;, italic(&quot;New York Times&quot;),
                                    &quot;. Updated &quot;, .(format(Sys.time(), &quot;%b %-d, %Y&quot;)))),
            x = &quot;Date&quot;,
            y = &quot;New cases&quot;
        )
    ```
--&gt;
	</description>
		</item>
	</channel>
</rss>
